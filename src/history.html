<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>History</title>
    <link rel="stylesheet" href="./assets/css/reset.css">
    <link rel="stylesheet" href="./assets/css/screen.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="assets/js/main.js"></script>
    <script defer src="assets/js/api.js"></script>
    <script src="assets/js/pages/history.js" type="module"></script>
</head>
<body>
<div id="app">
    <header-component></header-component>
    <main>
        <nav-component></nav-component>
        <subscription-component></subscription-component>
        <div class="history">
            <article v-show="flaggedIncidentsReady">
                <p> Filter by: </p>
                <select @change="filterByTypeFlagged($event)">
                    <option value="None"> None </option>
                    <option value="Assault"> Assault </option>
                    <option value="Murder"> Murder </option>
                    <option value="Theft"> Theft </option>
                    <option value="Vandalism"> Vandalism </option>
                </select>
                <h2>Incidents you flagged </h2>
                <ul>
                    <li v-if="flaggedIncidents.length === 0"><h3> No incidents flagged yet with this type </h3></li>
                    <li v-else v-for="incident in flaggedIncidents">
                        <div>
                            <h3>{{incident.type}}</h3>
                            <em class="label" v-for="label in incident.labels">{{label}}</em>
                            <em v-if="incident.state === 'CONFIRMED'" class="label">Confirmed</em>
                            <em v-else class="label">Declined</em>
                        </div>
                        <div>
                            <p>{{new Date(incident.datetime).toLocaleDateString()}}</p>
                            <p>{{new Date(incident.datetime).toLocaleTimeString()}} </p>
                        </div>
                    </li>
                </ul>
            </article>

            <article v-show="helpedIncidentsReady">
                <p> Filter by: </p>
                <select @change="filterByTypeHelped($event)">
                    <option value="None"> None </option>
                    <option value="Assault"> Assault </option>
                    <option value="Murder"> Murder </option>
                    <option value="Theft"> Theft </option>
                    <option value="Vandalism"> Vandalism </option>
                </select>
                <h2>Incidents you helped</h2>
                <ul>
                    <li v-if="helpedIncidents.length === 0"> <h3> No people helped yet with this type </h3> </li>
                    <li v-else v-for="incident in helpedIncidents">
                        <h4>You've helped: {{incident.reporterId}} </h4>
                        <div>
                            <h3>{{incident.type}}</h3>
                            <em class="label" v-for="label in incident.labels">{{label}}</em>
                        </div>
                        <div>
                            <p>{{new Date(incident.datetime).toLocaleDateString()}}</p>
                            <p>{{new Date(incident.datetime).toLocaleTimeString()}} </p>
                        </div>
                    </li>
                </ul>
            </article>
        </div>
    </main>
</div>
</body>
</html>
